{"entries":[{"timestamp":1768646311415,"editorVersion":"8.0.18","changes":[{"type":"edited","filename":"main.ts","patch":[{"start1":0,"length1":33,"diffs":[[1,"\n"]]}]},{"type":"edited","filename":"pxt.json","patch":[{"start1":2,"length1":23,"diffs":[[1,"    \"name\": \"Uten navn\",\n"]]},{"start1":205,"length1":39,"diffs":[[1,"        \"README.md\"\n"]]},{"start1":232,"length1":75,"diffs":[[1,"    \"additionalFilePaths\": []\n"]]}]},{"type":"added","filename":"test.ts","value":"// testene settes inn her; disse vil ikke kompilert så lenge denne pakken blir brukt som en utvidelse.\n"},{"type":"added","filename":"gy91.ts","value":"//% color=130 weight=100 icon=\"\\uf14e\" block=\"GY91\"\nnamespace GY91 {\n\n    const MPU = 0x68\n    const HMC = 0x1E\n\n    let gyroOffsetX = 0\n    let gyroOffsetY = 0\n    let gyroOffsetZ = 0\n\n    let yaw = 0\n    let lastTime = 0\n\n    //% block=\"initialiser GY91\"\n    //% group=\"Oppsett\"\n    //% weight=100\n    export function init(): void {\n        // MPU6050 wake\n        write8(MPU, 0x6B, 0x00)\n\n        // Gyro ±250 dps\n        write8(MPU, 0x1B, 0x00)\n        // Acc ±2g\n        write8(MPU, 0x1C, 0x00)\n\n        // HMC5883L\n        write8(HMC, 0x00, 0x70)\n        write8(HMC, 0x01, 0x20)\n        write8(HMC, 0x02, 0x00)\n\n        lastTime = input.runningTime()\n    }\n\n    // ==================================================\n    // AKSELEROMETER\n    // ==================================================\n\n    //% block=\"akselerasjon X\"\n    //% group=\"Akselerometer\"\n    export function accelX(): number {\n        return read16(MPU, 0x3B)\n    }\n\n    //% block=\"akselerasjon Y\"\n    //% group=\"Akselerometer\"\n    export function accelY(): number {\n        return read16(MPU, 0x3D)\n    }\n\n    //% block=\"akselerasjon Z\"\n    //% group=\"Akselerometer\"\n    export function accelZ(): number {\n        return read16(MPU, 0x3F)\n    }\n\n    // ==================================================\n    // GYROSKOP\n    // ==================================================\n\n    //% block=\"rotasjonshastighet X (°/s)\"\n    //% group=\"Gyroskop\"\n    export function gyroX(): number {\n        return (read16(MPU, 0x43) - gyroOffsetX) / 131\n    }\n\n    //% block=\"rotasjonshastighet Y (°/s)\"\n    //% group=\"Gyroskop\"\n    export function gyroY(): number {\n        return (read16(MPU, 0x45) - gyroOffsetY) / 131\n    }\n\n    //% block=\"rotasjonshastighet Z (°/s)\"\n    //% group=\"Gyroskop\"\n    export function gyroZ(): number {\n        return (read16(MPU, 0x47) - gyroOffsetZ) / 131\n    }\n\n    //% block=\"kalibrer gyroskop\"\n    //% group=\"Gyroskop\"\n    //% weight=90\n    export function calibrateGyro(): void {\n        let sx = 0\n        let sy = 0\n        let sz = 0\n\n        for (let i = 0; i < 50; i++) {\n            sx += read16(MPU, 0x43)\n            sy += read16(MPU, 0x45)\n            sz += read16(MPU, 0x47)\n            basic.pause(10)\n        }\n\n        gyroOffsetX = sx / 50\n        gyroOffsetY = sy / 50\n        gyroOffsetZ = sz / 50\n    }\n\n    // ==================================================\n    // MAGNETOMETER\n    // ==================================================\n\n    //% block=\"magnetfelt X\"\n    //% group=\"Magnetometer\"\n    export function magX(): number {\n        return read16(HMC, 0x03)\n    }\n\n    //% block=\"magnetfelt Y\"\n    //% group=\"Magnetometer\"\n    export function magY(): number {\n        return read16(HMC, 0x07)\n    }\n\n    //% block=\"magnetfelt Z\"\n    //% group=\"Magnetometer\"\n    export function magZ(): number {\n        return read16(HMC, 0x05)\n    }\n\n    //% block=\"kompassretning (grader)\"\n    //% group=\"Magnetometer\"\n    export function heading(): number {\n        let x = magX()\n        let y = magY()\n        let angle = Math.atan2(y, x) * 180 / Math.PI\n        if (angle < 0) angle += 360\n        return angle\n    }\n\n    // ==================================================\n    // ORIENTERING\n    // ==================================================\n\n    //% block=\"helning fremover/bakover (pitch)\"\n    //% group=\"Orientering\"\n    export function pitch(): number {\n        let ax = accelX()\n        let ay = accelY()\n        let az = accelZ()\n        return Math.atan2(-ax, Math.sqrt(ay * ay + az * az)) * 180 / Math.PI\n    }\n\n    //% block=\"helning sideveis (roll)\"\n    //% group=\"Orientering\"\n    export function roll(): number {\n        return Math.atan2(accelY(), accelZ()) * 180 / Math.PI\n    }\n\n    // ==================================================\n    // ROTASJON\n    // ==================================================\n\n    //% block=\"rotasjonsvinkel rundt Z (yaw)\"\n    //% group=\"Rotasjon\"\n    export function yawAngle(): number {\n        let now = input.runningTime()\n        let dt = (now - lastTime) / 1000\n        lastTime = now\n        yaw += gyroZ() * dt\n        return yaw\n    }\n\n    // ==================================================\n    // I2C HJELP\n    // ==================================================\n\n    function write8(addr: number, reg: number, val: number): void {\n        pins.i2cWriteBuffer(addr, Buffer.fromArray([reg, val]))\n    }\n\n    function read16(addr: number, reg: number): number {\n        pins.i2cWriteNumber(addr, reg, NumberFormat.UInt8BE)\n        let hi = pins.i2cReadNumber(addr, NumberFormat.UInt8BE)\n        let lo = pins.i2cReadNumber(addr, NumberFormat.UInt8BE)\n        let v = (hi << 8) | lo\n        return v > 32767 ? v - 65536 : v\n    }\n}"}]}],"snapshots":[{"timestamp":1768646311414,"editorVersion":"8.0.18","text":{"main.blocks":"<xml xmlns=\"http://www.w3.org/1999/xhtml\">\n  <block type=\"pxt-on-start\"></block>\n  <block type=\"device_forever\"></block>\n</xml>","main.ts":"\n","README.md":"","pxt.json":"{\n    \"name\": \"Uten navn\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\",\n        \"radio\": \"*\",\n        \"microphone\": \"*\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\"\n    ],\n    \"additionalFilePaths\": []\n}\n"}}],"shares":[],"lastSaveTime":1768646878680}